000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID. TSTP3.
000300
000400 ENVIRONMENT DIVISION.
000500 CONFIGURATION SECTION.
000600 SPECIAL-NAMES.
000700      DECIMAL-POINT IS COMMA.
000800 INPUT-OUTPUT SECTION.
001100 DATA DIVISION.
001800
001900 WORKING-STORAGE SECTION.
003414 01 GENERATED-RESULTS.
003415    05 GENERATED-RESULT OCCURS 10 TIMES.
003416       10 GENERATED-RANK       PIC 9(2).
003417       10 GENERATED-PRODUCT    PIC X(3).
003418       10 GENERATED-QUANTITY   PIC 9(3).
003419
003420 01 EXPECTED-RESULTS.
003421     05 EXPECTED-RESULT OCCURS 10 TIMES.
003422       10 EXPECTED-RANK       PIC 9(2).
003423       10 EXPECTED-PRODUCT    PIC X(3).
003430       10 EXPECTED-QUANTITY   PIC 9(3).
003444
003445 77 WS-I PIC 9(2) VALUE 0.
003446 01 LIB PIC X(30).
003447 01 L-SEP PIC X(30) VALUE ALL "*".
003500 COPY TESTCONT.
003600
003700 PROCEDURE DIVISION.
003800 MAIN-LOGIC.
003900     DISPLAY "********** TEST FRAMEWORK STARTED **********"
004000     PERFORM CAS-LOOP-ITEMS-TEST
004100     DISPLAY 'RUN ', TESTS-RUN, ' OK ', PASSES, ' KO ', FAILURES
004200     DISPLAY L-SEP
004300     PERFORM CAS-WITH-INCORRECT-EXPECTED
004400     DISPLAY 'RUN ', TESTS-RUN, ' OK ', PASSES, ' KO ', FAILURES
004500     DISPLAY L-SEP
004600     DISPLAY "********** TEST FRAMEWORK COMPLETED **********"
004700     STOP RUN.
004800 CAS-LOOP-ITEMS-TEST.
004810     MOVE 'CAS-LOOP-ITEMS-TEST' TO LIB
004820     DISPLAY "******** ", LIB, " ********"
004830     PERFORM INIT-EXPECTED-RESULTS
004840     CALL 'LOPPTST' USING GENERATED-RESULTS
004850     PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 1
004860         MOVE "RANK TEST" TO LIB
004870         CALL 'ASSEQP3' USING TEST-CONTEXT, LIB,
004880                 EXPECTED-RANK(WS-I), GENERATED-RANK(WS-I)
004890         MOVE "PRODUCT TEST" TO LIB
004891         CALL 'ASSEQP3' USING TEST-CONTEXT, LIB,
004892                 EXPECTED-PRODUCT(WS-I), GENERATED-PRODUCT(WS-I)
004893         MOVE "QUANTITY TEST" TO LIB
004894         CALL 'ASSEQP3' USING TEST-CONTEXT, LIB,
004895                 EXPECTED-QUANTITY(WS-I), GENERATED-QUANTITY(WS-I)
004896     END-PERFORM
004897     .
004898 CAS-WITH-INCORRECT-EXPECTED.
004899     MOVE 'CAS-WITH-INCORRECT-EXPECTED' TO LIB
004900     DISPLAY "******** ", LIB, " ********"
004901     MOVE 1 TO EXPECTED-RANK(1)
004902     MOVE "001" TO EXPECTED-PRODUCT(1)
004903     MOVE 150 TO EXPECTED-QUANTITY(1)
004904     MOVE 2 TO EXPECTED-RANK(2)
004905     MOVE "002" TO EXPECTED-PRODUCT(2)
004906     MOVE 25 TO EXPECTED-QUANTITY(2)
004907     CALL 'LOPPTST' USING GENERATED-RESULTS
004908     PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 1
004909         MOVE "RANK TEST" TO LIB
004910         CALL 'ASSEQP3' USING TEST-CONTEXT, LIB,
004911                 EXPECTED-RANK(WS-I), GENERATED-RANK(WS-I)
004912         MOVE "PRODUCT TEST" TO LIB
004913         CALL 'ASSEQP3' USING TEST-CONTEXT, LIB,
004914                 EXPECTED-PRODUCT(WS-I), GENERATED-PRODUCT(WS-I)
004915         MOVE "QUANTITY TEST" TO LIB
004916         CALL 'ASSEQP3' USING TEST-CONTEXT, LIB,
004917                EXPECTED-QUANTITY(WS-I), GENERATED-QUANTITY(WS-I)
004918     END-PERFORM
004919     .
004920
004921 INIT-EXPECTED-RESULTS.
004922     MOVE 1 TO EXPECTED-RANK(1)
004923     MOVE "001" TO EXPECTED-PRODUCT(1)
004924     MOVE 100 TO EXPECTED-QUANTITY(1)
004925     MOVE 2 TO EXPECTED-RANK(2)
004926     MOVE "002" TO EXPECTED-PRODUCT(2)
004930     MOVE 50 TO EXPECTED-QUANTITY(2)
005000     .
