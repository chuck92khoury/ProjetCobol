000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID. FORMATTE.
000300
000310 ENVIRONMENT DIVISION.
000320 CONFIGURATION SECTION.
000330 SPECIAL-NAMES.
000340     DECIMAL-POINT IS COMMA.
000350
000400 DATA DIVISION.
000500 WORKING-STORAGE SECTION.
000600
000610 01  WS-JOUR         PIC X(2).
000620 01  WS-MOIS         PIC X(2).
000630 01  WS-ANNEE        PIC X(4).
000640
000700 LINKAGE SECTION.
000803 01  WS-DATE         PIC X(10).
000900 01  RESULT          PIC X(10).
001000
001100 PROCEDURE DIVISION USING WS-DATE, RESULT.
001110
001300      IF  WS-DATE(3:1) =  '/' AND WS-DATE(6:1) = '/'
001310                AND WS-DATE(1:2) < 30 AND WS-DATE(4:2) < 12
001400       MOVE WS-DATE(1:2) TO WS-JOUR
001410       MOVE WS-DATE(4:2) TO WS-MOIS
001420       MOVE WS-DATE(7:4) TO WS-ANNEE
001440       MOVE WS-ANNEE TO RESULT(1:4)
001450       MOVE '-'      TO RESULT(5:1)
001460       MOVE WS-MOIS  TO RESULT(6:2)
001470       MOVE '-'      TO RESULT(8:1)
001480       MOVE WS-JOUR  TO RESULT(9:2)
001500     ELSE
002000        MOVE 'ERREURDATE' TO  RESULT
002100     END-IF
002200
002300      GOBACK.
