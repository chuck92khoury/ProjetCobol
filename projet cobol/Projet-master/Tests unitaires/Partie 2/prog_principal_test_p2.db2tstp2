000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID. TSTP2.
000300
000400 ENVIRONMENT DIVISION.
000500 CONFIGURATION SECTION.
000600 SPECIAL-NAMES.
000700      DECIMAL-POINT IS COMMA.
000800 INPUT-OUTPUT SECTION.
001100 DATA DIVISION.
001800
001900 WORKING-STORAGE SECTION.
002000 01  WS-DATE            PIC X(10).
002100 01  RESULT             PIC X(10).
002200 01  EXPECTED-RESULT    PIC X(10).
002300 01  LIB PIC X(30).
002400 01  L-SEP PIC X(30) VALUE ALL "*".
003400
003500 COPY TESTCONT.
003600
003700 PROCEDURE DIVISION.
004000***************CAS DATE FORMATTE*********************************
004100     PERFORM CAS-DATE-FORMATTE
004200     DISPLAY 'RUN ', TESTS-RUN, ' OK ', PASSES, ' KO ', FAILURES
004210     DISPLAY L-SEP
004300***************CAS DATE NON CONFORME1*****************************
004500     PERFORM CAS-DATE-NON-CONFORME1
004600     DISPLAY 'RUN ', TESTS-RUN, ' OK ', PASSES, ' KO ', FAILURES
004700     DISPLAY L-SEP
004800***************CAS DATE NON CONFORME2*****************************
004900     PERFORM CAS-DATE-NON-CONFORME2
005000     DISPLAY 'RUN ', TESTS-RUN, ' OK ', PASSES, ' KO ', FAILURES
005100     DISPLAY L-SEP
005900
006000     STOP RUN
006100     .
006300*****************************************************************
006400 CAS-DATE-FORMATTE.
006500*****************************************************************
006600     MOVE ZERO  TO RESULT
006700     MOVE '19/11/2024' TO WS-DATE
006800     MOVE '2024-11-19' TO EXPECTED-RESULT
006900     MOVE 'CAS-1' TO LIB
007000     DISPLAY "******** ", LIB, "*********"
007010     DISPLAY 'LA DATE EN ENTREE : ' WS-DATE
007100     CALL 'FORMATTE' USING WS-DATE, RESULT
007200     CALL 'ASSEQP2' USING TEST-CONTEXT, LIB,
007300                             EXPECTED-RESULT, RESULT
007400     .
007500*****************************************************************
007600 CAS-DATE-NON-CONFORME1.
007700*****************************************************************
007710     MOVE ZERO  TO RESULT
007711     MOVE '19-11-2024' TO WS-DATE
007750     MOVE '2024-11-19' TO EXPECTED-RESULT
007760     MOVE 'CAS-2' TO LIB
007770     DISPLAY "******** ", LIB, "*********"
007771     DISPLAY 'LA DATE EN ENTREE : ' WS-DATE
007780     CALL 'FORMATTE' USING WS-DATE, RESULT
007790     CALL 'ASSEQP2' USING TEST-CONTEXT, LIB,
007791                             EXPECTED-RESULT, RESULT
007792     .
007793 CAS-DATE-NON-CONFORME2.
007794*****************************************************************
007795     MOVE ZERO  TO RESULT
007796     MOVE '19/20/2024' TO WS-DATE
007797     MOVE 'ERREURDATE' TO EXPECTED-RESULT
007798     MOVE 'CAS-3' TO LIB
007799     DISPLAY "******** ", LIB, "*********"
007800     DISPLAY 'LA DATE EN ENTREE : ' WS-DATE
007900     CALL 'FORMATTE' USING WS-DATE, RESULT
008000     CALL 'ASSEQP2' USING TEST-CONTEXT, LIB,
008100                             EXPECTED-RESULT, RESULT
008200     .
